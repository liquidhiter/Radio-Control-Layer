<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Radio Control Layer (RCL): Generic Tx Test Command Handler</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Radio Control Layer (RCL)
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('generic_tx_test_handler.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Generic Tx Test Command Handler </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Introduction</h1>
<p>The generic Tx Test command allows to continuously transmit a modulated signal or Continuous Wave (CW), which is useful when characterizing a PHY or testing against an instrument. The following sections describe how the command can be configured and used, its life cycle, and how it fits into the <a class="el" href="_r_c_l_8h.html#struct_r_c_l" title="Global shared driver state. ">RCL</a> architecture.</p>
<p>In order to submit a Generic Tx Test command, the following steps must have taken place:</p>
<ol type="1">
<li><a class="el" href="_r_c_l_8h.html#struct_r_c_l" title="Global shared driver state. ">RCL</a> has been initialized (See <a class="el" href="_r_c_l_8h.html#a0dba4dc6bc994b9f25813b3ed6d975c2" title="Initializes the RCL driver state. ">RCL_init</a>) and a handle must exist (See <a class="el" href="_r_c_l_8h.html#ad250dbda0747820e489d38cdb268ecee" title="Initializes an RCL client instance. ">RCL_open</a>).</li>
<li>The <a class="el" href="commands_2generic_8h.html#struct_r_c_l___c_m_d___g_e_n_e_r_i_c___t_x___t_e_s_t__t" title="Generic transmitter test command. ">RCL_CMD_GENERIC_TX_TEST_t</a> command has been initialized and configured.</li>
<li>The command has been configured according to the needs of the user.</li>
</ol>
<p>Once these steps have been completed, <a class="el" href="_r_c_l_8h.html#a335ebd06e9591a1a9ec26bde80199d96" title="Submit RCL command object to be scheduled for execution. ">RCL_Command_submit</a> and <a class="el" href="_r_c_l_8h.html#adc809f6096147ac6e33641fb2161a859" title="Wait for a submitted command to complete. ">RCL_Command_pend</a> are called to effectively send and then wait for the command to conclude. Once this has happened, the callback and the command status can be used for error checking and the application can proceed according to its specification.</p>
<h1>Usage</h1>
<p>The Generic Tx Test command is normally employed when the user wants to do Tx testing (for example CW tests). For this reason, the application needs to define not only the type of test signal to be used, but also the stop conditions.</p>
<p>Since no actual packet is meant to be transmitted with this command, there is no need to set up and configure a Tx buffer. The following code snippet shows a normal use-case for the command.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> runGenericTxTest(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <a class="code" href="_r_c_l_8c.html#a0dba4dc6bc994b9f25813b3ed6d975c2">RCL_init</a>();</div><div class="line">    RCL_Handle handle = <a class="code" href="_r_c_l_8c.html#ad250dbda0747820e489d38cdb268ecee">RCL_open</a>(&amp;rclClient, &amp;LRF_configGfsk500Kbps);</div><div class="line"></div><div class="line">    <span class="comment">/* Declare command */</span></div><div class="line">    RCL_CmdGenericTxTest cmd;</div><div class="line">    cmd = <a class="code" href="commands_2generic_8h.html#a5835398f0570822b64908af2639c9a05">RCL_CmdGenericTxTest_DefaultRuntime</a>();</div><div class="line"></div><div class="line">    <span class="comment">/* Command configuration */</span></div><div class="line">    cmd.common.scheduling = <a class="code" href="_r_c_l___command_8h.html#ade08c929505da062070474163417817da39c41d2c31edf75e6c226a4613d313cb">RCL_Schedule_Now</a>;</div><div class="line">    cmd.common.runtime.callback = defaultCallback;</div><div class="line">    cmd.common.runtime.rclCallbackMask.value = <a class="code" href="_r_c_l___event_8h.html#a9e6384116d9e2d84f36990827d6e86f1">RCL_EventLastCmdDone</a>.value | <a class="code" href="_r_c_l___event_8h.html#a175760e464528c714aeb3755a304ff7a">RCL_EventCmdStarted</a>.value;</div><div class="line">    cmd.common.timing.relHardStopTime = <a class="code" href="_r_c_l___scheduler_8h.html#acdfb6b54cdc9e000704111729a8319a7">RCL_SCHEDULER_SYSTIM_US</a>(5000); <span class="comment">// Stop continuous wave after 5000 [us]</span></div><div class="line">    cmd.rfFrequency = FREQUENCY;</div><div class="line">    cmd.config.sendCw = 1; <span class="comment">// Send continuous wave</span></div><div class="line">    cmd.config.whitenMode = 1; <span class="comment">// Default whitening</span></div><div class="line">    cmd.config.txWord = 0;</div><div class="line">    cmd.common.status = <a class="code" href="_r_c_l___command_8h.html#ae591a974abf55ca701cf33c61554e0cda1097a97f59467483fb55c8b471cb3036">RCL_CommandStatus_Idle</a>;</div><div class="line"></div><div class="line">    <a class="code" href="_r_c_l_8c.html#a335ebd06e9591a1a9ec26bde80199d96">RCL_Command_submit</a>(handle, &amp;cmd);</div><div class="line">    <span class="comment">/* Wait for command to conclude  */</span></div><div class="line">    <a class="code" href="_r_c_l_8c.html#adc809f6096147ac6e33641fb2161a859">RCL_Command_pend</a>(&amp;cmd);</div><div class="line"></div><div class="line">    <a class="code" href="_r_c_l_8c.html#a768c2d6b577588b948f1bb02278c66ec">RCL_close</a>(handle);</div><div class="line">}</div></div><!-- fragment --> <h1>Architecture</h1>
<p>The Generic Tx Test command handler has a life cycle that corresponds to the duration of the transmission. Since the transmission is continuous, there is no implicit stop time. The duration of the command needs to be set up with a hard stop time, or the application needs to explicitly stop the transmission using the <a class="el" href="_r_c_l_8h.html#ac4a089549b3c1ef1d99ba364205c36d8" title="Stop a command. ">RCL_Command_stop</a> API.</p>
<div align="center">
<img src="inline_umlgraph_8.png" />
<div class="caption">
Generic Tx Test handler state machine</div>
</div>
<table class="doxtable">
<tr>
<th><a class="el" href="_r_c_l_8h.html#struct_r_c_l" title="Global shared driver state. ">RCL</a> Event (In) </th><th>Description  </th></tr>
<tr>
<td><em>setup</em> </td><td>Setup has been performed </td></tr>
<tr>
<td><em>timerStart</em> </td><td>Timer-based start signalled </td></tr>
</table>
<table class="doxtable">
<tr>
<th><a class="el" href="_r_c_l_8h.html#struct_r_c_l" title="Global shared driver state. ">RCL</a> Event (Out) </th><th>Description  </th></tr>
<tr>
<td><em>lastCmdDone</em> </td><td>The <a class="el" href="_r_c_l_8h.html#struct_r_c_l" title="Global shared driver state. ">RCL</a> is finished with the command </td></tr>
<tr>
<td><em>cmdStarted</em> </td><td>Command handler has accepted and started executing </td></tr>
</table>
<table class="doxtable">
<tr>
<th>LRF Event </th><th>Description  </th></tr>
<tr>
<td><em>opDone</em> </td><td>The PBE operation has finished </td></tr>
<tr>
<td><em>opError</em> </td><td>Something went wrong. Cause located in the PBE ENDCAUSE register </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="rcl_architecture.html">RCL Architecture</a></li><li class="navelem"><a class="el" href="rcl_command_handlers.html">Command Handlers</a></li><li class="navelem"><a class="el" href="generic_command_handlers.html">Generic Command Handlers</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
